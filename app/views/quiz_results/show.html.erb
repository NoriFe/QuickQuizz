<div class="page-container" data-controller="pop-up">
  <h1 class="page-title-s">Results</h1>

  <div class="donut-container">
    <div class="end-donut" style="--progress: <%= @show_result %>%;">
        <div class="end-donut__gap">
          <h2 class="quiz-result-percentage">
            <%= @show_result.to_i %> %
          </h2>
        </div>
    </div>
  </div>

  <div class="result-message-container">
    <% if @show_result.to_i == 100 %>
      <h2>Woohoo!<br/>Momma will be proud</h2>
    <% elsif @show_result.to_i >= 90 %>
      <h2>Daaaamn!<br/>You are a beast</h2>
    <% elsif @show_result.to_i >= 75 %>
      <h2>Not bad!<br/>Keep on keepin' on</h2>
    <% elsif @show_result.to_i >= 60 %>
      <h2>It's OK!<br/>You are a decent student</h2>
    <% elsif @show_result.to_i >= 40 %>
      <h2>Mehh...<br/>So good yet so bad</h2>
    <% elsif @show_result.to_i >= 20 %>
      <h2>Oh no...<br/>Did you study at all?</h2>
    <% elsif @show_result.to_i < 20  %>
      <h2>Cmon...<br/>That is not acceptable</h2>
    <% elsif @show_result.to_i <= 0  %>
      <h2>Excuse me??<br/>How can the score be negative?!?</h2>
    <% else %>
      <h2>What happened?<br/>There must be a mistake</h2>
    <% end %>
    <hr>
  </div>

  <% if @show_result < 100 %>
    <div>
      <h4 class="quiz-result-small-text">Learn from your mistakes</h4>
      <h4 class="quiz-result-xs-text mb-4">Suggestions generated by AI</h4>
      <% @wrong_answers.each do |wrong_answer| %>
        <div class="wide-button white-button small-medium-text" data-pop-up-target="question" data-action="pop-up#show"><%= wrong_answer.choice.question.question %></div>
        <% recommendation = (@quiz_recommendations.select { |a| a.answer == wrong_answer }).last %>

        <div data-pop-up-target="popUpAnswer" class="invisible">
          <div class="backgound-pop-up">
            <div class="card-basic pop-up">
              <h2 class="recommendation-title"><%= wrong_answer.choice.question.question %></h2>
              <%= recommendation["recommendation"] %>
              <div class="wide-button centered-button white-text mt-4" data-pop-up-target="popUpClose" data-action="pop-up#close">Close</div>
            </div>
          </div>
        </div>

      <% end %>
    </div>
  <% end %>
</div>
